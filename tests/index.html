<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Test</title>
    <script src="../build/cliJoin.js"></script>
    <script src="./dbString.js"></script>
</head>
<body>
<style>
    span{
        display: block;
    }

    .ok {
        color:green;
    }

    .err {
        color: red;
    }
</style>
<div id="report"></div>
    <script>
        let numberTest = 1;
        function Test(item, type) {
            if (typeof item === type) {
                document.getElementById("report").innerHTML += "<span class=ok>Test #"+numberTest+" OK: " + JSON.stringify(item) + "</span>";
            } else {
                document.getElementById("report").innerHTML +=  "<span class=err>Test #"+numberTest+" error</span>";
            }

            numberTest++;
        }

        if (typeof db !== "object") {
            document.write("Error initialization framework");
        }

        localStorage.removeItem("$___cliJoin_DB");
        localStorage.setItem("$___cliJoin_DB", jsonString);

        db.load();

        Test(
            db.test.find({"id":69}),
            "object"
        );

        Test(
            db.test.find({"id":69, "hash": "a0874bf253ae3a4b551903c6cb1a0145"}),
            "object"
        );

        Test(
            db.test.find({"hash": "a0874bf253ae3a4b551903c6cb1a0145", "id":69}),
            "object"
        );

        Test(
            db.test.find({"id":69, "hash": "a0874bf253ae3a4b551903c6cb1a0145", "date":"2020-09-08 06:30:06"}),
            "object"
        );

        Test(
            db.test.find({"id":9999, "hash": "a0874bf253ae3a4b551903c6cb1a0145"}),
            "undefined"
        );

        Test(
            db.test.insert({"id":999999, "hash": "JKLGIUGBjgkasdtkshgb", "data": "2020-01-01 01:01:01"}),
            "object"
        );
    </script>
</body>
</html>